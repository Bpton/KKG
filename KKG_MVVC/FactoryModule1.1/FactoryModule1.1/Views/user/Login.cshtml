@model FactoryModel.LoginViewModel
@{
    ViewBag.Title = "Login";
    Layout = "~/Views/Shared/_LayoutLogin.cshtml";
}
<head>
    <script src="~/Scripts/jquery-3.3.1.min.js"></script>
    <script type="text/javascript">
        function GotoDashboard() {
          //  var finyr = $("#ddlfinyr").val();
            var finyr = $("#ddlfinyr option:selected").text()
            
            $.ajax({
                type: "POST",
                url: "/User/Getfinyr",
                data: { finyr: finyr },
                dataType: "json",
                success: function (response) {
                    //alert(response.d);
                    window.location.href = "/Masterfac/Dashboard";
                },
                failure: function (response) {
                    alert(response.responseText);
                },
                error: function (response) {
                    alert(response.responseText);
                }
            });
         

        }
    </script>
</head>
<style>


    #CaptchaInputText {
        text-transform: uppercase;
    }
</style>
@using (Html.BeginForm("Login", "User", FormMethod.Post))
{
    @Html.AntiForgeryToken()



    <div class="login-panel">


        @if (ViewBag.errormessage == null || ViewBag.errormessage == "Entered Invalid Username and Password")
        {

            <form action="">
                @if (ViewBag.errormessage != null)
                {
                    <p class="alert alert-danger" id="successMessage">@ViewBag.errormessage</p>
                }
                <div class="form-group">
                    <div class="col-md-12 col-xs-12">
                        <h3>Login</h3>
                    </div>
                </div>
                @Html.ValidationSummary(true, "", new { @class = "text-danger" })

                <div class="form-group">

                    <div class="col-md-12 col-xs-12">
                        @Html.LabelFor(model => model.Username)
                        @Html.TextBoxFor(model => model.Username, new { @class = "form-control", @maxlength = 20 })
                        @Html.ValidationMessageFor(model => model.Username, "", new { @class = "text-danger" })
                    </div>
                </div>
                <div class="form-group">

                    <div class="col-md-12 col-xs-12">
                        @Html.LabelFor(model => model.Password)
                        @Html.PasswordFor(model => model.Password, new { @class = "form-control", @maxlength = 30 })
                        @Html.ValidationMessageFor(model => model.Password, "", new { @class = "text-danger" })
                    </div>
                </div>

                <div class="form-group">
                    <div class="col-md-offset-0 col-md-10">
                        <button type="submit" id="Login" class="btn btn-primary" value="Sign in To Account" style="width:150px;height:40px">Login</button>
                    </div>
                </div>

            </form>
        }
        else if (@ViewBag.errormessage == "successful")
        {
            <form action="">
                <div class="form-group">
                    <div class="col-md-12 col-xs-12">
                        @Html.Label("Finyear")
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-md-12 col-xs-12">
                        <select id="ddlfinyr" class="form-control" style="width:150px;">
                            @{var j = ViewBag.finyr;}
                            @{
                                foreach (var i in j)
                                {
                                    <option value=" @i.id "> @i.FinYear</option>
                                }
                            }
                        </select>
                    </div>
                </div>

                <div class="form-group">

                    <div class="col-md-12 col-xs-12">
                    </div>
                </div>
                <div class="form-group">
                    <div class="col-md-offset-0 col-md-10">
                        <input type="button" id="finyr" class="btn btn-primary" value="Proceed" onclick="GotoDashboard();" style="width:150px;height:40px" />
                    </div>
                </div>
            </form>
        }
    </div>
}

